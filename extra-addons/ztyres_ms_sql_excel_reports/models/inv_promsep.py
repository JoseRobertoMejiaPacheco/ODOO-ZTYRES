import pandas as pd
import numpy as np
import re

#pip install pyodbc sqlalchemy
#apt-get install unixodbc
from odoo import api, fields, models
import pandas as pd
import datetime
from dateutil.relativedelta import relativedelta

class MyModel(models.TransientModel):
    _name = 'ztyres_ms_sql_excel_reports_invprom'

    # Configuramos la semilla para la reproducibilidad
    def genererate_invprom_report(self):
        import pandas as pd


        report_data = []
        report_dataIVA = []
        product_template = self.env['product.template']
        product_pricelist = self.env['product.pricelist']
        domain = [
            ('default_code', '!=', False),
            ('x_studio_posicionamiento', '!=', False)
                ]
        res = product_template.search(domain)
        resPricelist = product_pricelist.search([])

        Pirelli20 = [
          
        ]

        Bridgestone20 = [
            
        ]
        
        Bridgestone34 = [('10304003', 0.98),('12589003', 0.98),('12031005', 0.98),('10281003', 0.965),('10290003', 0.98),('14961003', 0.97),('10390003', 0.98),('16100003', 0.98),
                        ('17704003', 0.98),('10366003', 0.98),('10382003', 0.96),('12636003', 0.96),('10415003', 0.965),('14971003', 0.98),('17161003', 0.96),('17372003', 0.96),
                        ('10426003', 0.98),('15986003', 0.98),('20340003', 0.98),('15987003', 0.98),('16582001', 0.98),('18679005', 0.98),('16320300', 0.98),('18223003', 0.96),
                        ('18986003', 0.96),('18975003', 0.96),('10466003', 0.96),('18581003', 0.96),('10472003', 0.98),('10341003', 0.98),('10476003', 0.98),('16680005', 0.96),
                        ('18705003', 0.98),('18573003', 0.98),('11160003', 0.98),('10871003', 0.96),('10505003', 0.96),('19228003', 0.96),('19106003', 0.96),('16303003', 0.96),
                        ('18988003', 0.95),('16658003', 0.96),('12596003', 0.96),('10492003', 0.945),('16948005', 0.98),('16741003', 0.96),('19517003', 0.96),('11186003', 0.98),
                        ('16855003', 0.96),('10962003', 0.96),('10983003', 0.98),('14767300', 0.95),('10999003', 0.98),('17731300', 0.96),('11242003', 0.98),('14959003', 0.98),
                        ('18741003', 0.95),('11265003', 0.96),('11009003', 0.98),('19206100', 0.95),('18742003', 0.95),('11272003', 0.985),('17262003', 0.95),('18497003', 0.95),
                        ('11124003', 0.985),('10770003', 0.96)
        ]

        Bridgestone1x14 = [
            
        ]

        Bridgestone4x34 = [('10304003', 0.98),('12589003', 0.98),('12031005', 0.98),('10281003', 0.965),('10290003', 0.98),('14961003', 0.97),('10390003', 0.98),('16100003', 0.98),
                           ('17704003', 0.98),('10366003', 0.98),('10382003', 0.96),('12636003', 0.96),('10415003', 0.965),('14971003', 0.98),('17161003', 0.96),('17372003', 0.96),
                           ('10426003', 0.98),('15986003', 0.98),('20340003', 0.98),('15987003', 0.98),('16582001', 0.98),('18679005', 0.98),('16320300', 0.98),('18223003', 0.96),
                           ('18986003', 0.96),('18975003', 0.96),('10466003', 0.96),('18581003', 0.96),('10472003', 0.98),('10341003', 0.98),('10476003', 0.98),('16680005', 0.96),
                           ('18705003', 0.98),('18573003', 0.98),('11160003', 0.98),('10871003', 0.96),('10505003', 0.96),('19228003', 0.96),('19106003', 0.96),('16303003', 0.96),
                           ('18988003', 0.95),('16658003', 0.96),('12596003', 0.96),('10492003', 0.945),('16948005', 0.98),('16741003', 0.96),('19517003', 0.96),('11186003', 0.98),
                           ('16855003', 0.96),('10962003', 0.96),('10983003', 0.98),('14767300', 0.95),('10999003', 0.98),('17731300', 0.96),('11242003', 0.98),('14959003', 0.98),
                           ('18741003', 0.95),('11265003', 0.96),('11009003', 0.98),('19206100', 0.95),('18742003', 0.95),('11272003', 0.985),('17262003', 0.95),('18497003', 0.95),
                           ('11124003', 0.985),('10770003', 0.96)
        ]

        kumo20 = [

        ]

        goodyear20 = [            

        ]

        conti20 = [

        ]
        
        outlet100 = [('2142773', 0.8477),('2231303', 0.8482),('2231973', 0.8494),('2250083', 0.809),('2250033', 0.8341),('2194213', 0.8169),('2178623', 0.8477),('2244353', 0.8173),
                     ('2232013', 0.8331),('2267923', 0.9296),('2231273', 0.8498),('2232043', 0.7992),('2250043', 0.8758),('2247033', 0.8026),('2232073', 0.8932),('2194153', 0.8489),
                     ('2232193', 0.8341),('2210803', 0.8098),('2268723', 0.7983),('2268663', 0.8496),('2232273', 0.7798),('2218733', 0.8173),('2207323', 0.8501),('2165843', 0.8502),
                     ('2262353', 0.7286),('2207013', 0.8496),('2179993', 0.8496),('2245403', 0.8528),('2202133', 0.9067),('2321563', 0.8246),('2210663', 0.8509),('2268803', 0.8499),
                     ('2231633', 0.8118),('2204763', 0.8503),('2207333', 0.8907),('2207163', 0.8508),('2189263', 0.8464),('2232263', 0.8467),('2207273', 0.8506),('2261493', 0.7591),
                     ('2182963', 0.8501),('2197773', 0.8094),('2248213', 0.8262),('2305573', 0.8508),('2305593', 0.8511),('2206593', 0.7365),('2206443', 0.8139),('2228213', 0.8096),
                     ('2268743', 0.8502),('2232303', 0.8522),('2246653', 0.8023),('2206943', 0.8501),('2230243', 0.8509),('2156143', 0.8506),('2261733', 0.8504),('2289923', 0.8512),
                     ('2259103', 0.8509),('2266193', 0.8102),('2259063', 0.8512),('2207253', 0.8508),('2183283', 0.8506),('2289893', 0.8347),('2290093', 0.8589),('2177603', 0.8508),
                     ('2289873', 0.8507),('23208631', 0.851),('1854113', 0.8511),('2168653', 0.8512),('2320863', 0.8437),('2283873', 0.8512),('2325633', 0.8512),('2182273', 0.8511),
                     ('2283913', 0.8513),('2176893', 0.8513),('2203803', 0.7862),('2248283', 0.8513),('2230103', 0.8509),('2230093', 0.8511),('2290043', 0.851),('2231143', 0.8125),
                     ('2289973', 0.8467),('2177663', 0.8513),('2320943', 0.8511),('2169393', 0.9159),('2313973', 0.8326),('2320883', 0.8514),('1854213', 0.8514),('2283773', 0.8514),
                     ('2263853', 0.8513),('2248263', 0.7879),('2290003', 0.8267),('2304183', 0.7861),('2168513', 0.8513),('2263823', 0.7923),('2230023', 0.8133),('2142873', 0.8512),
                     ('2289933', 0.8512),('2231003', 0.8515),('2313993', 0.7872),('2181973', 0.8511),('2283763', 0.8514),('2304163', 0.8512),('2283853', 0.8512),('1854313', 0.8515),
                     ('2168453', 0.8516),('2169233', 0.7025),('2283803', 0.8515),('2283743', 0.8517),('2208283', 0.7784),('2177843', 0.8072),('2207083', 0.8517),('2262703', 0.8299),
                     ('2283883', 0.8511),('2178003', 0.851),('2168613', 0.8514),('2262523', 0.8125),('2281953', 0.8012),('101137', 0.7986),('114099', 0.7976),('90000002521', 0.7976),
                     ('114214', 0.7977),('90000002759', 0.7981),('114881', 0.7959),('114834', 0.8066),('114218', 0.7975),('90000005346', 0.7975),('114289', 0.7976),('115104', 0.7974),
                     ('109620', 0.8726),('109622', 0.7956),('90000005345', 0.796),('114868', 0.8485),('115211', 0.7986),('116642', 0.798),('115132', 0.9006),('114841', 0.7974),
                     ('114839', 0.9373),('90000024350', 0.7985),('109649', 0.7982),('104605', 0.7986),('105408', 0.7992),('90000002529', 0.7977),('110460', 0.799),('90000028849', 0.7987),
                     ('114215', 0.7976),('115587', 0.791),('116042', 0.7984),('115231', 0.7525),('114127', 0.7991),('115408', 0.7989),('116393', 0.7989),('102299', 0.7986),
                     ('14870003', 0.8249),('10333003', 0.7998),('17704003', 0.7926),('17291200', 0.7965),('17694003', 0.8676),('19378003', 0.7749),('15312300', 0.7219),('15986003', 0.8086),
                     ('20340003', 0.8249),('17705300', 0.8141),('15987003', 0.8249),('16582001', 0.8141),('16089300', 0.7817),('17229300', 0.8186),('17296200', 0.7463),('17709300', 0.8101),
                     ('14938300', 0.8064),('19338200', 0.8297),('14877003', 0.7817),('14929200', 0.7965),('14679005', 0.7921),('16948005', 0.8286),('12570100', 0.7886),('16335003', 0.6495),
                     ('18751003', 0.8487),('10579300', 1.1322),('17237003', 0.7851),('17731300', 0.8205),('11234003', 0.8249),('11242003', 0.8249),('11258100', 0.8249)
        ]

        lista_con_precios1 = [('2142773', 768.46),('TP00285700', 672.67),('2231303', 866.11),('03504580000', 1089.65),('ETP00280000', 866.95),('2250023', 907.07),('108111', 1191.54),
                              ('9027074', 630.34),('28010194', 816.13),('17J54101', 695.13),('2250083', 1001.86),('107435', 1085.79),('160606', 827.22),('107901', 1186.41),
                              ('110524', 1176.39),('114862', 882.16),('TP00284800', 853.52),('18599003', 635.04),('2194213', 743.89),('2178623', 743.89),('109620', 667.07),
                              ('15552960000', 736.76),('90000025813', 664.63),('2232013', 760.59),('2244353', 1159.95),('2038200', 1189.32),('15485630000', 1165.82),('110075', 1044.63),
                              ('TL00211200', 1333.24),('04512170000', 1379.99),('2196263', 1192.49),('ETP00278600', 860),('109206', 1611.86),('ETP00274000', 1108.96),('2231273', 1344.6),
                              ('2232043', 796.84),('109622', 760.11),('90000005345', 835.71),('114834', 803.99),('15501920000', 1063.36),('4078200', 1323.88),('10063220', 521.31),
                              ('2250043', 859.36),('106846', 1147.57),('100473', 869.35),('10A54233', 992.61),('1326300', 1269.14),('2868700', 1420.98),('2247033', 800.78),
                              ('114881', 826.98),('2232073', 854.95),('10094240', 743.02),('ETL00060800', 1492.76),('TL00549200', 1491.11),('2210803', 1448.77),('90000007541', 1404),
                              ('109649', 1985.65),('2158533', 1568.08),('2202323', 1255.12),('ETP00099200', 1074.04),('03584090000', 1765.62),('2180013', 1050.13),('ETP23844300', 1001.12),
                              ('TP00273000', 952.44),('2180003', 1176.9),('111462', 1802.08),('115673', 1115.86),('15481540000', 1553.03),('15501620000', 1553.03),('2254013', 1330.8),
                              ('14870003', 1643.97),('2327700', 1717.96),('2194153', 983.43),('2255500', 1342.51),('15494610000', 1305.58),('TP00272900', 944.72),('10A55293', 1010.45),
                              ('12599500', 692.34),('2232193', 1019.09),('15570430000', 1286.31),('90000007441', 898.45),('29062023', 827.22),('28068353', 913.39),('2509500', 1318.18),
                              ('1178300', 1318.18),('TP00280600', 954.42),('2207063', 1012.53),('2189183', 1012.53),('10094310', 938.2),('10054310', 922.74),('114882', 1009.34),
                              ('ETL00075600', 1482.93),('2253000', 1801.46),('2144113', 1738.88),('2218393', 1738.88),('04512160000', 1751.17),('111348', 1832.49),('04513980000', 2120.09),
                              ('ETL00264100', 2338.94),('2268763', 1176.94),('3994200', 1632.34),('ETP00112900', 1089.4),('2206403', 1211.76),('2268723', 1160.63),('2261043', 1236.18),
                              ('ETP00897400', 1142.72),('15502420009', 1908.42),('2268663', 1219.78),('ETP39614600', 1196.53),('2253503', 1434.48),('03560730000', 2053.98),
                              ('2232273', 1373.79),('110779', 2063.84),('2040400', 3088.65),('3914400', 1946.41),('2268643', 1285.37),('2218733', 1185.6),('2328900', 1375.29),
                              ('15490310000', 1331.44),('290620230', 910.02),('90000037470', 969.4),('10A56413', 1022.58),('1860500', 1937.06),('3683100', 2049.21),('2165843', 1500.34),
                              ('1999200', 2117.75),('2207893', 1533.68),('10063360', 761.88),('ETP00283000', 1081.29),('15986003', 1250.41),('111442', 1734.85),('2203100', 1894.63),
                              ('2262353', 1268.27),('15571260008', 1222),('105894', 1470.55),('111601', 1590.38),('2179993', 1225.73),('2207013', 1225.73),('15987003', 1454.02),
                              ('2244433', 1467.85),('04515940000', 1970.51),('TP00280900', 1222.68),('2245403', 1886.73),('2164300', 2131.34),('110970', 2068.5),('28067173', 1281.66),
                              ('111532', 1684.1),('103405', 2068.5),('15591880000', 1271.25),('10054380', 862.52),('ETL00251100', 1853.3),('2321563', 1639.89),('1575800', 1975.8),
                              ('ETP39206400', 1361.2),('2197793', 1178.31),('114868', 1060.91),('2245303', 1828.14),('2210773', 1828.14),('2207073', 1274.8),('10P55381', 1569.53),
                              ('28010926', 1130.36),('114105', 1391.17),('2210663', 2066.56),('ETL00074800', 1883.53),('2268803', 1343.18),('ETP42055100', 1249.91),('03567130000', 2019.97),
                              ('03590770000', 2089.63),('2231633', 1436.82),('ETP00056300', 1384.37),('28953891', 1444.32),('2204763', 1578.2),('110843', 1943.86),('2189313', 1336.5),
                              ('2761300', 1557.7),('2442800', 1592.32),('10455003', 1462.24),('2206333', 1366.2),('03574910000', 2205.8),('2856400', 2183.45),('15570160000', 2069.76),
                              ('2576100', 2231.97),('4062600', 1904.09),('3914700', 1946.41),('115670', 1469.92),('15482660000', 1864.11),('28062171', 1321.24),('2267933', 1504.95),
                              ('2262443', 1622.76),('2207163', 1936.97),('3916000', 2411.76),('03506940000', 2269.29),('03581100000', 2269.29),('110313', 2472.61),('3503410000', 1625.56),
                              ('4077400', 1822.25),('10A56433', 1073.89),('TP00298600', 1370.49),('3909200', 1943.4),('3236800', 1986.58),('111530', 1914.81),('90000002529', 1555.25),
                              ('115104', 1407.11),('114215', 1444.86),('2261493', 1416.54),('2207273', 1821.59),('110761', 1841.74),('03544290000', 1697.82),('115818', 1679.64),
                              ('ETP00177000', 1855.29),('2744200', 2282.74),('9021115', 1370.02),('2182963', 1463.54),('114208', 1282.87),('2197773', 1312.45),('114099', 1458.06),
                              ('2210793', 1992.23),('2219223', 1992.23),('15591900000', 1359.75),('2164800', 2253.94),('90000003461', 1115.38),('10085450', 1267.25),('2248213', 1658.85),
                              ('2184993', 1867.13),('15448450000', 1928.67),('ETP41064400', 1589.63),('TP27048700', 1536.33),('2305573', 2017.98),('2290153', 2067.04),('114839', 1263.6),
                              ('104605', 2652.55),('2305593', 2249.3),('ETP00069400', 1921.57),('2206593', 2262.52),('2917400', 1888.34),('2206443', 1591.92),('2268033', 1591.92),
                              ('2253653', 1591.92),('ETP00054700', 2326.25),('2462500', 3449.65),('15591950000', 1565.06),('2233183', 2712.69),('106565', 1723.55),('19336200', 3546.31),
                              ('2230783', 1951.43),('2228213', 1380.97),('4226600', 1727.07),('2288900', 1727.07),('4226700', 1727.07),('2462400', 2838.41),('106798', 1680.57),
                              ('2233173', 2313.85),('108796', 1640.08),('107629', 1640.08),('2005700', 2901.49),('2268743', 1483.22),('17709300', 2097.05),('2232373', 2871.44),
                              ('3559800', 2171.6),('2374200', 3282.94),('03564090000', 1992.21),('116037', 1545.6),('2233153', 2639.86),('4077600', 2004.9),('19338200', 2516.02),
                              ('03583970000', 3181.57),('2028000', 3242.29),('115671', 1528.65),('2417900', 2219.86),('3592900', 2219.86),('15501880009', 2449.38),('2268703', 1820.13),
                              ('3952300', 2216.06),('3768100', 2216.06),('ETP00238300', 1672.89),('4077800', 2137.18),('2261813', 3117.52),('14929200', 2471.32),('111541', 2235.14),
                              ('ETP00148800', 1520.01),('15494230000', 2242.55),('2246653', 2207.57),('3916200', 2264.38),('ETP00793200', 1629.01),('115850', 1710.31),('14751200', 2287.13),
                              ('3590700', 2314.7),('1855813', 2520.33),('15491500000', 2560.39),('03121030009', 2484.09),('2206943', 1450.78),('4079100', 1992.66),('290620231', 910.02),
                              ('ETP00250800', 1710),('4223400', 2106.26),('ETP00177200', 1735.97),('2230243', 2040.57),('3594400', 2276.67),('2156143', 1757.21),('2261733', 1567.94),
                              ('2678300', 1893.77),('ETP00251000', 1780.19),('ETP25715800', 1756.22),('2208143', 2093.04),('12573500', 1169.79),('114209', 1321.2),('114103', 1427.45),
                              ('TL00061300', 1932.52),('2245283', 2110.58),('ETP25714000', 1594.45),('TP00176900', 1656.88),('114840', 1547.16),('2289923', 2489.72),('1617500', 2671.7),
                              ('2156713', 2503.94),('115211', 2617.73),('10878003', 2100.63),('109101', 3054.78),('2253673', 1925.19),('03504370000', 1810.49),('ETP00080200', 1589.98),
                              ('2559300', 2265.31),('4258500', 2741.35),('2206683', 2349.92),('2442000', 2011.12),('12570100', 2208.69),('2206473', 1876.24),('2268613', 2054.76),
                              ('107497', 2135.22),('ETP00905500', 1626.55),('116033', 1724.13),('2656100', 2114.3),('16335003', 2141.45),('ETP00206300', 2090.38),('14762300', 3132.56),
                              ('2271433', 2499.56),('3591400', 2264.25),('03548800000', 2925.59),('ETP00124500', 2218.63),('116394', 2537.69),('2744100', 2998.64),('2259103', 2040.08),
                              ('18751003', 2118.62),('2744300', 2518.34),('03564940000', 2240.86),('3830100', 2518.34),('03584340009', 2240.86),('3830500', 2574.3),('3643900', 2574.3),
                              ('03584400000', 3336.72),('15482680000', 2290.65),('2706600', 2574.3),('3150000', 2988.71),('10579300', 2226.03),('03549490000', 2698.99),('3919200', 3055.13),
                              ('114913', 2378.96),('03571250000', 2967.63),('232323', 2491.32),('15498470000', 2967.63),('03543280000', 4103.64),('2248233', 2621.49),('ETP00124000', 2374.57),
                              ('90000002521', 1528.38),('90000005346', 1452.18),('2206953', 1666.01),('ETP00040900', 1656.13),('115719', 1529.32),('90000002776', 1819.54),
                              ('15498480009', 2453.09),('2266193', 2007.9),('3149900', 2398.46),('3643200', 2398.46),('116042', 2233.61),('15498480000', 2419.75),('110741', 2431.57),
                              ('108592', 2500.71),('115853', 1849.17),('30062023', 1646.02),('2259063', 2482.3),('ETL00085800', 1999.4),('04514920000', 3039.06),('2229313', 2482.3),
                              ('ETP00354800', 1787.15),('03592320009', 2191.14),('2207253', 1994.9),('ETP00250600', 1955.29),('2266183', 1842.24),('2722100', 2546.6),('110750', 2378.63),
                              ('2172143', 1883.18),('ETP00177100', 1967.27),('3918200', 2436.08),('2183263', 2112.23),('2268173', 2112.23),('3918300', 2491.34),('17237003', 2539.96),
                              ('114218', 1449.05),('2183283', 1783.69),('2289893', 2055.39),('15481000000', 2399.87),('115133', 1841.21),('111382', 2347.61),('10036593', 1607.94),
                              ('115807', 2026.33),('1854113', 2395.83),('2177603', 1768.11),('2290093', 1887.93),('2289873', 1848.92),('2320863', 2178.42),('109371', 1926.75),
                              ('2168653', 2492.51),('111381', 1889.61),('115132', 1644.63),('10C55600', 1517.96),('114289', 1487.13),('116642', 1844.77),('114841', 1407.57),
                              ('3955300', 2452.15),('115139', 2024.24),('115228', 2150.15),('10035607', 1536.83),('2283873', 2531.61),('2325633', 2528.09),('2182273', 2320.41),
                              ('2726300', 3154.5),('109088', 3320.17),('290620232', 2547.66),('2283913', 2624.17),('1617100', 3043.97),('2177643', 2535.02),('1826600', 4485.14),
                              ('2654900', 1649.74),('2153700', 1649.74),('ETP00086000', 2625.71),('2234743', 3163.79),('ETP00085300', 1682.38),('2206493', 1753.21),('2220400', 2406.26),
                              ('2230773', 2510.36),('ETP00068700', 2109.71),('1902000', 2599.14),('3917200', 2657.13),('3816900', 2657.13),('2206633', 2110.28),('2654800', 1741.64),
                              ('2206433', 1780.9),('2220500', 1780.34),('2403800', 1780.34),('4223600', 1796.5),('2232363', 3087.04),('ETP01946300', 1749.19),('ETP43106200', 2853.81),
                              ('2206503', 2136.65),('101321', 2631.6),('2016900', 1836.42),('2176893', 2643.6),('ETP00071500', 2320.41),('290620233', 2157.54),('2546000', 2261.5),
                              ('2263283', 2702.34),('03567240000', 2710.03),('2203803', 2664.55),('ETP00126700', 2273.61),('3917300', 3043.97),('15498750000', 3011.92),('2206673', 2176.3),
                              ('2261803', 3267.88),('ETP00475200', 1835.06),('ETP4310870G', 3018.75),('3378300', 2325.56),('2248193', 2700.68),('2884900', 2822.92),('3920000', 2885.65),
                              ('2010200', 3094.1),('2248283', 2620.28),('3919300', 2981.94),('114095', 1585.46),('114212', 1605.41),('2230103', 2114.3),('3918400', 2636.5),
                              ('15500960000', 2609.22),('3597500', 2695.08),('2230093', 2273.89),('ETP00251800', 2137.16),('2693100', 2589.8),('TP00312700', 2016.1),('2722200', 2601.86),
                              ('3917600', 2589.8),('2169453', 2304.61),('2283903', 2307.9),('110749', 2391.82),('2290043', 2223.49),('2231143', 2039.12),('115229', 2293.16),
                              ('2723300', 2387.64),('115134', 1867.96),('90009037090', 1909.47),('107562', 2292.95),('1864000', 2415.14),('2289973', 2616.42),('2177663', 2598.53),
                              ('2742100', 3099.24),('2169413', 2293.8),('2721900', 2767.66),('90000039344', 3533.44),('2320883', 2769.18),('2320943', 2287.61),('2313973', 2099.05),
                              ('1854213', 2819.47),('2289903', 2297.61),('114304', 2478.04),('114127', 3868.52),('114116', 2506.73),('115212', 2829.97),('17J36691', 1216.16),
                              ('103785', 3489.94),('2283773', 2916.02),('TP00099000', 2410.58),('17J37711', 1356),('3973500', 2979.14),('2247643', 2474.05),('03519330000', 2598.89),
                              ('3789800', 3430.82),('03576070009', 2444),('114615', 2811.68),('3789900', 3707.14),('2263853', 2694.73),('3976500', 3109.72),('03593150000', 3217.44),
                              ('28953013', 2316.3),('90009023913', 2425.65),('03548790000', 3714.16),('3919400', 3406.01),('2263293', 2669.46),('110812', 3982.64),('28952949', 2254.77),
                              ('2711500', 3481.69),('2219373', 3416.66),('2147823', 3025.69),('ETP00124700', 2570.34),('03583690000', 2916.62),('16632300', 3097.76),('2297900', 2821.82),
                              ('2263303', 2481.71),('ETP43118100', 2140.45),('ETP00126800', 2159.74),('2248263', 2939.95),('ETL43225000', 2941.55),('1862500', 3280.64),('110460', 3615.82),
                              ('ETP00126900', 2491.39),('2207213', 3053.63),('90000026127', 2645.13),('2323000', 3353.54),('03548830000', 2861.41),('90000028849', 2829.29),
                              ('ETP00127000', 2545.13),('111588', 2460.64),('15571940000', 2913.92),('10065730', 1611.44),('114213', 1544.41),('2230053', 2575.46),('1862400', 2878.18),
                              ('2725200', 3265.03),('03548840000', 2667.09),('2230693', 2787.27),('2231103', 3042.45),('ETP00244800', 2111.09),('ETP00167500', 2111.09),('3918600', 2436.08),
                              ('90000002759', 1886.81),('ETP39235000', 2061.68),('114219', 1627.9),('2290003', 2238.67),('2168513', 2619.31),('2304183', 2180.73),('2320843', 2469.19),
                              ('2371400', 2988.71),('115210', 2743.61),('115230', 2551.73),('03549420000', 2464.26),('107472', 2699.39),('23208431', 2524.06),('2283933', 2371.78),
                              ('2169353', 2424.49),('107532', 3825.27),('ETP00120000', 2409.5),('03137230000', 2299.61),('2263793', 2732.51),('28051218', 2341.73),('2271403', 3105.61),
                              ('2263823', 2826.15),('2263803', 2744.29),('2733400', 3872.93),('3920300', 3958.99),('03540280000', 3090.86),('2567000', 3958.99),('03591180000', 3445.95),
                              ('03590750000', 2742.75),('2230033', 3030.74),('3919600', 3394.07),('ETP00251900', 2512.52),('2230023', 2862.34),('2354200', 3100.64),('ETP45301500', 2490.28),
                              ('104121', 2654.78),('3920400', 3100.64),('15492440000', 3413.13),('2142873', 2450.36),('2207123', 3315.73),('2228113', 2450),('2283863', 2935.58),
                              ('3918700', 2799.67),('ETP00353000', 2384.4),('2230733', 2996.47),('116032', 2072.18),('15571850000', 2786.89),('2506800', 2799.67),('111441', 3534.42),
                              ('2289933', 2417.69),('2231003', 3115.94),('2314013', 2456.39),('111438', 3041.46),('90000002836', 2259.49),('90000038778', 2435.96),('2205283', 2456.39),
                              ('110747', 2732.99),('115136', 2415.97),('115235', 2907.04),('2722600', 2935.97),('2283843', 2594.89),('3918800', 2501.33),('114963', 4410.96),
                              ('116035', 2056.47),('115773', 2630.46),('11258100', 2643.68),('2168493', 2708.45),('2283783', 2340.08),('115231', 2660.06),('2721700', 2878.18),
                              ('116393', 3283.95),('115810', 2338.49),('115824', 2633.53),('101137', 2430.85),('2313993', 2079.42),('4128600', 2542.64),('2181973', 2291.01),
                              ('2723500', 3099.24),('ETP00250900', 2502.69),('115137', 2297.47),('114636', 3670.84),('115815', 2477.95),('115408', 3153.31),('115143', 2785.5),
                              ('115593', 3340.78),('115822', 3253.85),('115225', 3212.49),('ETP00120300', 2548.47),('2290033', 3005.65),('TP43186100', 2605.54),('2283893', 3316.58),
                              ('2169273', 3068.1),('115775', 2800.91),('2304163', 2467),('1854313', 3156.14),('2283763', 2944.68),('2168453', 3225.61),('1555400', 2966.96),
                              ('2283853', 2532.58),('1961700', 3320.29),('2726000', 2966.96),('1911913', 3156.14),('107474', 2742.18),('115587', 3340.58),('115234', 2906.29),
                              ('115812', 2503.13),('115222', 3276.35),('3373800', 3050.12),('2270393', 2860.28),('28953903', 2478.06),('2271383', 2950.28),('90000024350', 2368.92),
                              ('03542190000', 4920.01),('2567200', 3055.13),('3973100', 3055.13),('1629900', 3055.13),('03582040000', 5815.64),('2168200', 5003.14),('90000003470', 2663.66),
                              ('3836300', 3839.98),('2263833', 3167.8),('90000032647', 2750.02),('3920800', 4092.5),('2263843', 3628.48),('03572210009', 3301.02),('2169233', 2548.51),
                              ('1555300', 2512.71),('2248200', 2604.08),('ETP00252000', 2705.04),('3920600', 2512.71),('102299', 2550.44),('ETP00252100', 2974.13),('2722800', 2988.71),
                              ('4128500', 2845.74),('3920700', 2893.64),('2169213', 2614.57),('101619', 2549.72),('3586400', 3055.13),('ETP00028400', 2710.61),('2283803', 3164.39),
                              ('2169193', 3074.39),('2722700', 3320.29),('115774', 2854.9),('3594800', 3209.76),('115776', 3528.98),('115804', 3805.31),('28030803', 2765.4),
                              ('2723900', 3320.29),('4125700', 3320.29),('2262633', 4494.4),('2283743', 3604.55),('2726400', 3651.87),('2177823', 3649.68),('115799', 3837.47),
                              ('9022179', 2413.11),('2262643', 3953.08),('2208283', 1512.25),('10P34800', 1015),('90000047263', 1644.22),('2217000', 5901.94),('03114490000', 4337.76),
                              ('2423000', 5630.29),('111616', 3484.86),('ETP00195800', 3194.3),('3594700', 2491.34),('04515960000', 4326.31),('2177843', 3453.09),('2281973', 3674.64),
                              ('90000032613', 3773.25),('ETP00353400', 2769.96),('04513900000', 4294.21),('04514770000', 4077.56),('111191', 4617.91),('115777', 4000.61),
                              ('ETP00251700', 2872.4),('2202500', 3412.31),('2207083', 3685.8),('2177883', 3412.3),('115594', 3756.14),('115816', 2830.92),('115226', 3624.07),
                              ('1961800', 3320.29),('115223', 3724.85),('109142', 3996.15),('20230623', 4171.42),('ETP00125400', 3194.24),('2567600', 3508.34),('03136610000', 2833.41),
                              ('2271503', 3575.16),('2567500', 5862.39),('03541860000', 4924.82),('2612200', 4366.6),('ETP45418200', 3169.95),('2262703', 4273.66),('105408', 4422.35),
                              ('28030952', 3427.89),('115997', 3810.33),('114656', 4706.14),('2155693', 3517.47),('ETP00130900', 2847.46),('03542210000', 6233.06),('2723700', 4071.97),
                              ('2107223', 4318.46),('2230983', 4299.72),('2168613', 2892.94),('2283883', 2267.57),('2178003', 2208.79),('116141', 2080.67),('10035863', 1845.21),
                              ('1582500', 2380.82),('115227', 2233.83),('115208', 2908.51),('2270733', 2957.23),('115138', 2311.92),('104209', 2258.6),('2625900', 4315.02),
                              ('115361', 3837.47),('1550000', 4502.91),('2281983', 3421.19),('2262523', 4357.34),('2281953', 4404.1),('290620234', 2957.94),('2262543', 4339.57),
                              ('2262553', 4404.83),('115805', 4192.7),('28516905', 5050.02),('10026010', 1783.71),('10024160', 1003.31),('10026310', 1998.31),('10027281', 2019.36),
                              ('10027312', 2687.95)
        ]



        vals = {}
        for rec in res:
            ccvi = '%s%s%s-%s' % (rec.x_studio_cara, rec.x_studio_capas, rec.x_studio_ndice_de_velocidad, rec.x_studio_indice_carga)
            if rec.qty_available:
                vals = {
                    'ID': rec.id,
                    'Codigo': rec.default_code or '',
                    'Medida': rec.x_studio_medida_1 or '',
                    'CCV_IC': ccvi,
                    'Modelo': rec.x_studio_modelo_1 or '',
                    'Marca': rec.x_studio_marca or '',
                    'Tier': rec.x_studio_posicionamiento or '',
                    'DOT': rec.product_variant_id.dot_range if rec.product_variant_id.dot_range else '',
                    'Inv': rec.qty_available or 0,
                    'Mayoreo': 0,
                    'Precio esperado promoción 1X14': 0,
                    'Bs14': 0,
                    'Precio esperado promoción 4X34': 0,
                    'Bs34': 0,
                    'Aplica en ambas promociones': '',
                    'Precio esperado promoción por periodo': 0,
                    'Mínimo de llantas para que aplique esta promoción': 0,
                    'Marca aplicable a la promoción': ''
                }
                
                for cod in lista_con_precios1:
                    if cod[0]== rec.default_code:
                        vals.update({'Outlet': cod[1]})

                for cod in goodyear20:
                    if cod[0]== rec.default_code:
                        vals.update({'Precio esperado promoción por periodo': cod[1]})
                        vals.update({'Mínimo de llantas para que aplique esta promoción': 20})
                        vals.update({'Marca aplicable a la promoción': 'Goodyear 20'})
                        
                for cod in outlet100:
                    if cod[0]== rec.default_code:
                        vals.update({'Precio esperado promoción por periodo': cod[1]})
                        vals.update({'Mínimo de llantas para que aplique esta promoción': 100})
                        vals.update({'Marca aplicable a la promoción': 'Outlet 100'})

                for cod in conti20:
                    if cod[0]== rec.default_code:
                        vals.update({'Precio esperado promoción por periodo': cod[1]})
                        vals.update({'Mínimo de llantas para que aplique esta promoción': 20})
                        vals.update({'Marca aplicable a la promoción': 'Conti 20'})

                for cod in kumo20:
                    if cod[0]== rec.default_code:
                        vals.update({'Precio esperado promoción por periodo': cod[1]})
                        vals.update({'Mínimo de llantas para que aplique esta promoción': 20})
                        vals.update({'Marca aplicable a la promoción': 'Kumho 20'})

                for cod in Pirelli20:
                    if cod[0]== rec.default_code:
                        vals.update({'Precio esperado promoción por periodo': cod[1]})
                        vals.update({'Mínimo de llantas para que aplique esta promoción': 20})
                        vals.update({'Marca aplicable a la promoción': 'Pirelli 20'})

                for cod in Bridgestone20:
                    if cod[0]== rec.default_code:
                        vals.update({'Precio esperado promoción por periodo': cod[1]})
                        vals.update({'Mínimo de llantas para que aplique esta promoción': 20})
                        vals.update({'Marca aplicable a la promoción': 'Bridgestone 20'})
                        
                for cod in Bridgestone34:
                    if cod[0]== rec.default_code:
                        vals.update({'Precio esperado promoción por periodo': cod[1]})
                        vals.update({'Mínimo de llantas para que aplique esta promoción': 34})
                        vals.update({'Marca aplicable a la promoción': 'BS34'})
                        
                #if rec.x_studio_marca =='MAXXIS':
                #    vals.update({'Precio esperado promoción por periodo': 0})
                #    vals.update({'Mínimo de llantas para que aplique esta promoción': 50})
                #    vals.update({'Marca aplicable a la promoción': 'BONO 3000'})


                #for cod in Bridgestone1x14:
                #    if cod[0]== rec.default_code:
                #        vals.update({'Precio esperado promoción 1X14': cod[1]})
                #        vals.update({'Bs14': 14})
                #        vals.update({'Aplica en ambas promociones': 'Bs14'})

                #        for cod1 in Bridgestone4x34:
                #            if cod1[0] ==  cod[0]:
                #                vals.update({'Bs34': 34})
                #                vals.update({'Precio esperado promoción 4X34': cod1[1]})
                #                vals.update({'Aplica en ambas promociones': 'Bs14/34'})
                
                for cod in Bridgestone4x34:
                    if cod[0] ==  rec.default_code:
                        vals.update({'Bs34': 34})
                        vals.update({'Precio esperado promoción 4X34': cod[1]})
                        vals.update({'Aplica en ambas promociones': 'Bs34'})

                report_data.append(vals)


                
        for dato in report_data:
            for lista_precio in resPricelist:
                if lista_precio.id in [1]:
                    for Precio in lista_precio.item_ids:
                        if dato['ID'] == Precio.product_tmpl_id.id:
                            if dato['Mayoreo'] > Precio.fixed_price:
                                dato['Mayoreo'] = Precio.fixed_price
                            elif dato['Mayoreo'] == 0:
                                dato['Mayoreo'] = Precio.fixed_price

                                
        report_dataIVA = report_data

        for dato in report_dataIVA:
            var1 = float(0)
            var2 = float(0)
            var3 = float(0)
            var4 = float(0)
            var5 = float(0)
            valorIVA = float(0)
            if dato['Mayoreo'] != '' and dato['Mayoreo'] is not False:
                var1 = dato['Mayoreo'] or 0
            if dato['Precio esperado promoción 1X14'] != '' and dato['Precio esperado promoción 1X14'] is not False:
                var2 = dato['Precio esperado promoción 1X14'] or 0
            if dato['Precio esperado promoción 4X34'] != '' and dato['Precio esperado promoción 4X34'] is not False:
                var3 = dato['Precio esperado promoción 4X34'] or 0
            if dato['Precio esperado promoción por periodo'] != '' and dato['Precio esperado promoción por periodo'] is not False:
                var4 = dato['Precio esperado promoción por periodo'] or 0

        # Concatenar el nuevo DataFrame con el DataFrame originalPrecio volumen

        df = pd.DataFrame(report_data)
        df2 = pd.DataFrame(report_dataIVA)

        df2['Mayoreo'] = pd.to_numeric(df2['Mayoreo'], errors='coerce')
        df2['Mayoreo'].fillna(0, inplace=True)
        df2['Mayoreo'] = df2['Mayoreo'] * 1.16

        df2['Precio esperado promoción 1X14'] = pd.to_numeric(df2['Precio esperado promoción 1X14'], errors='coerce')
        df2['Precio esperado promoción 1X14'].fillna(0, inplace=True)
        df2['Precio esperado promoción 1X14'] = df2['Precio esperado promoción 1X14']

        df2['Precio esperado promoción 4X34'] = pd.to_numeric(df2['Precio esperado promoción 4X34'], errors='coerce')
        df2['Precio esperado promoción 4X34'].fillna(0, inplace=True)
        df2['Precio esperado promoción 4X34'] = df2['Precio esperado promoción 4X34']

        df2['Precio esperado promoción por periodo'] = pd.to_numeric(df2['Precio esperado promoción por periodo'], errors='coerce')
        df2['Precio esperado promoción por periodo'].fillna(0, inplace=True)
        df2['Precio esperado promoción por periodo'] = df2['Precio esperado promoción por periodo']


        df2['Outlet'] = pd.to_numeric(df2['Outlet'], errors='coerce')
        df2['Outlet'].fillna(0, inplace=True)
        df2['Outlet'] = df2['Outlet'] * 1.16
   
        reports_core = self.env['ztyres_ms_sql_excel_core']
        reports_core.action_insert_dataframe(df,'reporte_invpromsep_siniva')
        reports_core.action_insert_dataframe(df2,'reporte_invpromsep_coniva')